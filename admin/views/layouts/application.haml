- # encoding: utf-8
!!! 5
%html{:lang => 'ru'}
  %head
    %meta{:content => 'text/html; charset=utf-8', 'http-equiv' => 'Content-Type'}
    %meta{:name => :viewport, :content => 'width=device-width,initial-scale=1'}
    %title= @title.present? ? "#{@title} | Rozario Admin" : "Rozario Admin"
    =favicon_tag 'favicon.ico'
    %link{:href => '//fonts.googleapis.com/css?family=Varela', :rel => :stylesheet}
    %link{:href => '/stylesheets/admin.css', :rel => :stylesheet}
    %link{:href => "//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css", :rel => "stylesheet"}/
    %link{:href => "//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css", :rel => "stylesheet"}/
    %script{:src => "//code.jquery.com/jquery-1.12.4.js"}
    %script{:src => "//code.jquery.com/ui/1.12.1/jquery-ui.js"}


    =stylesheet_link_tag 'bootstrap', 'redactor', 'bootstrap-select.min', 'application'
    
    / Подключаем стили адаптивной боковой панели
    =render 'layouts/admin_sidebar_styles'
    =javascript_include_tag 'jquery-1.9.0.min', 'redactor.min', 'redactor.ru', (Padrino.env == :production ? 'bootstrap/bootstrap.min' : %w[bootstrap/bootstrap-affix bootstrap/bootstrap-alert bootstrap/bootstrap-button bootstrap/bootstrap-carousel bootstrap/bootstrap-collapse bootstrap/bootstrap-dropdown bootstrap/bootstrap-tooltip bootstrap/bootstrap-transition bootstrap/bootstrap-typeahead bootstrap/bootstrap-modal bootstrap/bootstrap-popover bootstrap/bootstrap-scrollspy bootstrap/bootstrap-tab]), 'bootstrap-select.min', 'defaults-ru-RU', '/ckeditor2/ckeditor.js', :application
    = javascript_include_tag 'jquery-migrate-1.0.0.js', 'jquery-ui.js', 'chosen.order.jquery.min.js'
    =javascript_include_tag 'contacts.js'
  %script{:src => "//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"}
  %script{:src => "//unpkg.com/vue@2.5.17/dist/vue.js"}
  %script{:src => "//unpkg.com/vue-select@2.5.1/dist/vue-select.js"}
  %script{:src => "//unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.js"}
  %script{:src => "//unpkg.com/clipboard@2.0.0/dist/clipboard.min.js"}
  %link{:href => "//unpkg.com/vue-multiselect@2.1.0/dist/vue-multiselect.min.css", :rel => "stylesheet"}/
  %body
    / Адаптивная навигация с гамбургером
    %nav.navbar.navbar-fixed-top.admin-navbar
      .navbar-inner
        .container-fluid
          / Гамбургер кнопка для мобильных устройств
          %button.navbar-toggle.sidebar-toggle{:type => "button"}
            %span.sr-only Toggle navigation
            %span.icon-bar
            %span.icon-bar
            %span.icon-bar
          
          =link_to 'Rozario', url(:base_index), :class => 'navbar-brand', :title => 'Rozario Admin'
          
          - if current_account
            %ul.nav.navbar-nav.pull-right
              %li.navbar-edit-account=link_to tag_icon(:user), url(:accounts, :edit, :id => current_account.id), :title => pat(:profile), :class => 'navbar-nav-link'
              %li.navbar-logout
                =button_to :logout, url(:sessions, :destroy), :method => :delete, :class => 'navbar-nav-form' do
                  =content_tag :button, tag_icon(:off), :type => :submit, :title => pat(:logout), :class => 'navbar-nav-form-link'

    / Основная структура с боковой панелью
    .admin-wrapper
      / Боковая панель
      .admin-sidebar
        .sidebar-header
          %h4 Навигация
          %button.sidebar-close.visible-xs{:type => "button"}
            %span &times;
        
        %ul.sidebar-menu
          - menu_entries.each do |project_module|
            %li{:class => "sidebar-item #{('active' if request.path_info =~ /^#{project_module.path}/)}"}
              =link_to I18n.t("padrino.admin.menu.#{project_module.name}"), project_module.path('/admin'), :class => 'sidebar-link'
          %li{:class => "sidebar-item #{'active' if request.path_info =~ /tags/}"}
            =link_to "Теги", '/admin/tags', :class => 'sidebar-link'
          %li{:class => "sidebar-item #{'active' if request.path_info =~ /slides/}"}
            =link_to "Слайды", '/admin/slides', :class => 'sidebar-link'
          %li{:class => "sidebar-item #{'active' if request.path_info =~ /payment/}"}
            =link_to "Способы оплаты", '/admin/payment_methods', :class => 'sidebar-link'
          %li{:class => "sidebar-item #{'active' if request.path_info =~ /seo/}"}
            =link_to "SEO", '/admin/seo', :class => 'sidebar-link'
          %li{:class => "sidebar-item #{'active' if request.path_info =~ /comments/}"}
            =link_to "Комментарии", '/admin/comments', :class => 'sidebar-link'
          %li{:class => "sidebar-item #{'active' if request.path_info =~ /smiles/}"}
            =link_to "Отзывы", '/admin/smiles', :class => 'sidebar-link'
      
      / Затемнение для мобильных устройств
      .sidebar-overlay
      
      / Основной контент
      .admin-content
        .container-fluid.main
          .main-wrapper
            =[:error, :warning, :success, :notice].map { |type| flash_tag(type, :class => "alert alert-#{type} fade in", :bootstrap => true) }.join.html_safe
            =yield
            .main-wrapper-push

    %footer
      .footer-wrapper.container
        %p.pull-left
          Copyright &copy;
          =Time.now.year
          Rozario — Powered by Padrino v.#{Padrino.version} and
          =link_to 'kereal.ru', 'http://kereal.ru', :target => :_blank, :class => 'footer-links-link', :title => 'kereal.ru'
        %ul.pull-right.footer-links
          %li= link_to tag_icon(:heart, 'whiteplus'), 'http://whiteplus.ru', :target => :_blank, :class => 'footer-links-link', :title => 'Белый плюс любит вас :)'
          /%li= link_to tag_icon(:home, 'web'), 'http://www.padrinorb.com', :target => :_blank, :class => 'footer-links-link'
          /%li= link_to tag_icon(:heart, 'blog'), 'http://www.padrinorb.com/blog', :target => :_blank, :class => 'footer-links-link'
          /%li= link_to tag_icon(:github, 'code'), 'https://github.com/padrino/padrino-framework', :target => :_blank, :class => 'footer-links-link'
          /%li= link_to tag_icon(:twitter, 'twitter'), 'http://twitter.com/padrinorb', :target => :_blank, :class => 'footer-links-link'
    :javascript
      var btns = document.querySelectorAll('.copy-tag');
      var clipboard = new ClipboardJS(btns);
    
    / Подключаем JavaScript для управления боковой панелью
    =render 'layouts/admin_sidebar_scripts'
